package ejerciciosT1;
import java.io.*;
import org.w3c.dom.*;
import javax.xml.parsers.*;
import javax.xml.transform.*;
import javax.xml.transform.dom.*;
import javax.xml.transform.stream.*;


public class Ejercicio8 {
	public static void main(String[] args) {
		try {
			File f = new File("/home/glyaxz/Escritorio/Testing/departamentos.dat");
			RandomAccessFile raf = new RandomAccessFile(f, "r");
			//id->nombre->localidad->deps
			int[] id = new int[5], deps = new int[5];
			int position = 0, intAux;
			char[] nombre = new char[10],
					localidad = new char[10];
			char aux;
			
			DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
			DocumentBuilder builder = factory.newDocumentBuilder();
			DOMImplementation implementation = builder.getDOMImplementation();
			Document document = implementation.createDocument(null, "Departamentos", null);
			document.setXmlVersion("1.0");
			
			for(;;) {
				raf.seek(position);
				for(int i = 0; i < nombre.length ; i++) {
					id[i] = raf.readInt();
					raf.seek(position);
					position += 4;
					aux = raf.readChar();
					nombre[i] = aux;
					raf.seek(position);
					position += 20;
					aux = raf.readChar();
					raf.seek(position);
					localidad[i] = aux;
					position += 20;
					deps[i] = raf.readInt();
					position += 4;
					raf.seek(position);
				}
				for(int i = 0; i < id.length; i++) {
					if(id[i] > 0) {
						Element raiz = document.createElement("Departamento");
						document.getDocumentElement().appendChild(raiz);

						CrearElemento("id", Integer.toString(id[i]), raiz, document);
						CrearElemento("nombre", nombre[i], raiz, document);
						CrearElemento("localidad", localidad[i], raiz, document);
						CrearElemento("deps", Integer.toString(deps[i]), raiz, document);
						
					}
				}
				
			}
			
			
		}catch (ParserConfigurationException|IOException e) {
			System.out.println(e.getMessage());
		}
	}
	
	static void CrearElemento(String datoDepart, String valor, Element raiz, Document document) {
		Element elem = document.createElement(datoDepart);
		Text text = document.createTextNode(valor);
		raiz.appendChild(elem);
		elem.appendChild(text);
	}	
	
	static void CrearElemento(String datoDepart, int valor, Element raiz, Document document) {
		Element elem = document.createElement(datoDepart);
		Text text = document.createTextNode(Integer.toString(valor));
		raiz.appendChild(elem);
		elem.appendChild(text);
	}
}
,